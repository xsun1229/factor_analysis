---
title: "weak_IV_bias"
author: "XSun"
date: "2020-08-16"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Introduction

We can get more significant associations when trained weights and performed association test one the same data set. We suspect that besides the over-fitting issuem, there seems to be weak IV bias issue. So we tried to eliminate that. 


## Methods

1. Finding the strong cis-snps. The cis-snps I used in [One Sample Setting](https://xsun1229.github.io/factor_analysis/cg-onesample.html) are those within 500kb from the TSS of genes, some of them might not be strong instruments of the genes. So I tried to find the strong cis-snps.

  - The GTEx V8 variants dataset contains 10,403,249 variants.
  
  - The cis-snp~gene pair dataset contains 149,431,316 pairs which include 9,756,636 variants.
  
  - Strong cis-snps: I computed the FDR from p-values for each pairs in cis-snp~gene pair dataset. Then selected those pairs with FDR<0.1. These pairs contains 641,652 variants. I names these 641,652 variants as strong group.
  
  - Weak group: 9,761,597 variants in GTEx variants dataset but not in strong cis-snps set are selected as weak group
  
  - GWAS: I did association tests for these two group with PLIER-Canonical LVs. The tests are adjusted for 10 genotype PCs.
  
  
  
## Results

### GWAS results

I did GWAS analysis for all 128 LVs, but I just list the results for the LVs have low pval_test here (LV90,50,125).I also add negative control here(LV47,81) 

#### LV90 

- GWAS results (all variants, for comparison)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv90.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv90.jpeg" width="40%">
</figure>

- GWAS results (variants in strong group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv90_strong.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv90_strong.jpeg" width="40%">
</figure>


- GWAS results (variants in weak group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv90_weak.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv90_weak.jpeg" width="40%">
</figure>


#### LV50 

- GWAS results (all variants, for comparison)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv50.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv50.jpeg" width="40%">
</figure>

- GWAS results (variants in strong group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv50_strong.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv50_strong.jpeg" width="40%">
</figure>


- GWAS results (variants in weak group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv50_weak.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv50_weak.jpeg" width="40%">
</figure>


#### LV125 

- GWAS results (all variants, for comparison)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv125.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv125.jpeg" width="40%">
</figure>

- GWAS results (variants in strong group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv125_strong.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv125_strong.jpeg" width="40%">
</figure>


- GWAS results (variants in weak group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv125_weak.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv125_weak.jpeg" width="40%">
</figure>


#### LV47-negative control

- GWAS results (all variants, for comparison)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv47.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv47.jpeg" width="40%">
</figure>

- GWAS results (variants in strong group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv47_strong.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv47_strong.jpeg" width="40%">
</figure>


- GWAS results (variants in weak group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv47_weak.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv47_weak.jpeg" width="40%">
</figure>

#### LV81-negative control

- GWAS results (all variants, for comparison)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv81.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv81.jpeg" width="40%">
</figure>

- GWAS results (variants in strong group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv81_strong.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv81_strong.jpeg" width="40%">
</figure>


- GWAS results (variants in weak group) 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/qq_unif_lv81_weak.jpeg" width="40%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/man_lv81_weak.jpeg" width="40%">
</figure>