---
title: "Results for KEGG PCs from CEDAR data set ( pathways have > 40 genes included)"
author: "XSun"
date: "2021-08-05"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

# **Overview**

We selected the results for pathways have >40 genes from [the results regressing out <= 10 PEER factors](https://xsun1229.github.io/factor_analysis/cedar_kegg_26_qc_d1k_pruned_10peer.html)

We added colocalization analysis for the pairs show sign consistency (at p-value < 0.002), the loci are +-250kb/500kb from the reported SNPs. 

We just listed the pairs show sign consistency in the tables below.

'pval_in_resampling_2' in the tables means the p-value from [adaptive resampling](https://xsun1229.github.io/factor_analysis/factors_traits.html#32_sign_consistency_checking). 'pval_in_resampling' in the tables were computed from 1000 times resampling.

# **Enrichment Summary** 

**1000 times resampling**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_cell_sum_kegg_qc_pruned_10peer_40genes_1000t.jpg" width="150%">
</figure>

**adaptive resampling**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_cell_sum_kegg_qc_pruned_10peer_40genes_adap.jpg" width="150%">
</figure>

# **Barplot to show the number of SNPs have FDR <0.2 that each pair contains**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/40_kegg_hist_snp_all_CEDAR_10peer.jpg" width="150%">
</figure>


# **Detailed results for 6 cell types**

## **B cell**

### effectsize fitting summary 


```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_bcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

EUR.IBD_pwy202_pc2 -	Cholinergic synapse [The intestinal cholinergic anti‚Äêinflammatory pathway](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5063935/)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy202_pc2_EUR.IBD_pval5e8_bcell.jpeg" width="60%">
</figure>

T1D_pwy151_pc4 - Cellular senescence: [Our findings demonstrate that beta cell senescence is a significant component of the pathogenesis of T1D and indicate that clearance of senescent beta cells could be a new therapeutic approach for T1D](https://pubmed.ncbi.nlm.nih.gov/30799288/)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy151_pc4_T1D_pval5e8_bcell.jpeg" width="60%">
</figure>

### SNP details

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_bcell_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_bcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_bcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_bcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```


## **monocyte CD14**


### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd14_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```


### SNP details


```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd14_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd14_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_cd14_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_cd14_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

## **neutrophils CD15**

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd15_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd15_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd15_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_cd15_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_cd15_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```


## **T cell(CD4)**

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_tcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```


### SNP details

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_tcell_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_tcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_tcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_tcell_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```


## **T cell(CD8)**

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_thy_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```


### SNP details

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_thy_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_thy_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_thy_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_thy_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```



## **platelet**

### effectsize fitting summary

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_plt_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details


```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_plt_pruned_10peer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```



### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plt_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


### Colocalization results

#### +-250kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_500kb_plt_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```

#### +-500kb from the SNP

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/coloc_sum_1000kb_plt_cedar_qc_kegg_pruned_10peer_40genes.rdata")
DT::datatable(summary, options = list(pageLength =5))
```