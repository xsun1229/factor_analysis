---
title: "cedar_kegg_pruned_pruned_26_qc_d1k_pruned"
author: "XSun"
date: "2021-07-09"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Introduction

In this part, we used new PCs as the covariates in association test. The new PCs are computed using 'bigsnpr' R package. When computing the PCs, the related samples are removed, the outlier samples are removed, the SNPs are thinned with the R2 >0.2.

We used 26 immune and blood cell traits in this part, they are: "mch","mchc","mcv","rdw","ret","baso","cd14","pct","pdw","mpv","hct","hgb","ret","mono","T1D", "EUR.IBD","EUR.UC","EUR.CD","ukb.allasthma","eo","wbc","rbc","myeloid_wbc","gran","lymph","neut","allergy"

The genotype data used in this part were imputed genenotype data. Before imputation, we did quality control for them.

## Summary 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_kegg_pruned_sum1_pruned.png" width="80%">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_kegg_pruned_sum2_pruned.png" width="80%">
</figure>

## Detailed results for 6 cell types

### neutrophils CD15

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_cd15_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>

#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_cd15_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```

#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd15_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```




### B cell

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_bcell_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>


#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_bcell_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_bcell_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


### T cell(CD8)

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_thy_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>


#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_thy_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_thy_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### T cell(CD4)

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_tcell_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>


#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_tcell_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_tcell_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### platelet

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_plt_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>


#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_plt_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plt_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

### monocyte CD14

#### Histogram to show the number of SNPs that each pair contains

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_cd14_cedar_qc_kegg_pruned.jpeg" width="80%">
</figure>


#### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_cd14_cedar_qc_kegg_pruned.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


#### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd14_cedar_qc_kegg_pruned.rdata")
DT::datatable(sum, options = list(pageLength =5))
```