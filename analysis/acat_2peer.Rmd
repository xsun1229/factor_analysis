---
title: "ACAT"
author: "XSun"
date: "2022-10-03"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
suppressMessages(library(ggplot2))
suppressMessages(library(gridExtra))
```


# Results


## ACAT results from real data

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE,fig.height=10, fig.width=15}

type <- c("B cell (CD19+)","Monocyte (CD14+)","Leukocyte (CD15+)","Platelet","T cell (CD4+)","T cell (CD8+)")
path <- c("4.B_cell_kegg","6.CD14_positive_monocyte_kegg","8.CD15_positive_leukocyte_kegg","16.platelet_kegg","10.T_cell_kegg","14.thymocyte_kegg")

p <- list()
for (i in 1:length(type)){
  
  file_acat_results <- paste0("/project2/xinhe/xsun/CEDAR/",path[i],"/8.regress_out_peer/2peer/2.ECT/results/acat_allpairs.rdata")
  load(file_acat_results)
  
  plotdata <- data.frame(observed = -log10(sort(acat_all)),
                         expected = -log10(ppoints(length(acat_all))))
  
  p[[i]] <- ggplot(plotdata) + theme_bw(base_line_size =0.3,) +
    geom_point(aes(expected, observed), shape = 1, size = 3, color= "steelblue") +
    geom_abline(intercept = 0, slope = 1, alpha = 0.6, color = "red") +
    ggtitle(type[i]) + theme(plot.title = element_text(hjust = 0.5)) +
    labs(x = expression(paste("Expected -log"[10],"(p-value)")),
         y = expression(paste("Observed -log"[10],"(p-value)"))) +
    
    theme(axis.title.x = element_text(size = 22),
          axis.text.x = element_text(size = 20, color = "black"),
          axis.title.y = element_text(size = 22),
          axis.text.y = element_text(size = 20, color = "black"),
          text= element_text(family="Times New Roman"))
  
}

all <- grid.arrange(p[[1]],p[[2]],p[[3]],p[[4]],p[[5]],p[[6]], nrow = 2)

```

## ACAT results from real data (MHC removed)

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE,fig.height=10, fig.width=15}

type <- c("B cell (CD19+)","Monocyte (CD14+)","Leukocyte (CD15+)","Platelet","T cell (CD4+)","T cell (CD8+)")
load("/project2/xinhe/xsun/CEDAR/ACAT_randomsnp_regress_peer/results/acat_real_MHCremoved.rdata")

p <- list()
for (i in 1:length(type)){
  acat_all <<- acat_allcelltypes_MHCremoved[[i]]
  
  plotdata <- data.frame(observed = -log10(sort(acat_all)),
                         expected = -log10(ppoints(length(acat_all))))
  
  p[[i]] <- ggplot(plotdata) + theme_bw(base_line_size =0.3,) +
    geom_point(aes(expected, observed), shape = 1, size = 3, color= "steelblue") +
    geom_abline(intercept = 0, slope = 1, alpha = 0.6, color = "red") +
    ggtitle(type[i]) + theme(plot.title = element_text(hjust = 0.5)) +
    labs(x = expression(paste("Expected -log"[10],"(p-value)")),
         y = expression(paste("Observed -log"[10],"(p-value)"))) +
    
    theme(axis.title.x = element_text(size = 22),
          axis.text.x = element_text(size = 20, color = "black"),
          axis.title.y = element_text(size = 22),
          axis.text.y = element_text(size = 20, color = "black"),
          text= element_text(family="Times New Roman"))
  
}

all <- grid.arrange(p[[1]],p[[2]],p[[3]],p[[4]],p[[5]],p[[6]], nrow = 2)

```

## ACAT results from random data 


## ACAT results from random data (MHC removed)




