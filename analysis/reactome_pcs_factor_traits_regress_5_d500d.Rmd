---
title: "Studying effects of PCs on phenotypes (REACTOME) â€“ After regressing out 5 GTEx PEER factors, 'AND' LD Clumping, Whole blood "
author: "XSun"
date: "2021-04-13"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## **Introduction**

In this part, we inferred 6105 PCs from 1221 REACTOME pathways and studied the effects of these PCs on phenotype. We regressed out top 5 PEER factors from the GTEx data set. 

The candidate SNPs are the same with [Whole blood PCs](https://xsun1229.github.io/factor_analysis/kegg_pcs_factor_traits_regress_5_d500d.html)

## **Effectsize analysis -- effect size fitting**

For the pairs have more than 2 SNPs with FDR <0.2 (3139 pairs), we also tested the effectsize correlation(effect size in GWAS and effect size in factos-association). We fitted the effectsize using: effectsize in GWAS ~ 0 +effectsize in factor-association. We recorded the p-values and r-squareds in the fitting.

To make our results more reliable, we did resampling. We resampled the SNPs without replacement and fitted the points with intercept = 0 again and recorded the r-squareds to compute the p-values in resampling. The 'p-value from resampling' is computed by: (number of more extreme values)/(times of resampling).The resampling was repeated 1000 times.

There are 608 pairs show sign consistency (have p-values < 0.05 in resampling, 3.87 fold enrichment). There are 274 pairs at p-value < 0.01, 8.72 fold enrichment). 


```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d500d_reactome_wb.txt", header = T)
DT::datatable(sum, options = list(pageLength =5))
```

After deleting the pairs whose 'num_snp_noMHC' == 0, we got 2932 pairs. We used extended MHC area here ([chr6:25726063-33400644](https://www.nature.com/articles/nrg1489)) There are 494 pairs show sign consistency (have p-values < 0.05 in resampling, 3.36 fold enrichment). There are 197 pairs at p-value < 0.01, 6.7 fold enrichment).  

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_noMHC_pcs_reg_5_extend_d500d_reactome_wb.txt", header = T)
DT::datatable(sum, options = list(pageLength =5))
```

To summarize the results, We made a scatter plot of all trait-LV pairs. The x-axis shows the R2 in fitting, and the y-axis show the -log10-p values from resampling. To make the plot more informative, Each point represent a trait-LV pair. Different colors show the number of SNPs passing the FDR threshold for each pair.

For the pairs have p-value = 0 in resampling, we set the p-value = 0.001 in the plot below.

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsizesum_0.2_reactome_wb.jpeg" width="80%">
</figure>


## **Detailed results for HDL_pwy1077_pc4 **

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/info_table_annot_pval_reactome_pc_reg_5_wb_HDL.rdata")

DT::datatable(final_full, options = list(pageLength =5))
```

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy1077_pc4_HDL_pval5e8_reactome_wb.jpeg" width="80%">
</figure>


## **Detailed results for plt_pwy1035_pc3 **

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/info_table_annot_pval_reactome_pc_reg_5_wb_plt.rdata")

DT::datatable(final_full, options = list(pageLength =5))
```

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy1035_pc3_plt_pval5e8_reactome_wb.jpeg" width="80%">
</figure>


## **Detailed results for eo_pwy728_pc2 **

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/info_table_annot_pval_reactome_pc_reg_5_wb_eo.rdata")

DT::datatable(final_full, options = list(pageLength =5))
```

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy728_pc2_eo_pval5e8_reactome_wb.jpeg" width="80%">
</figure>

## **Detailed results for EUR.IBD **

EUR.IBD has 4 factors have p-value == 0  in resampling. The table below shows the SNP details of these 4 factors.

We found 3 SNPs drive different pathways:

```{r echo=T, eval=FALSE}
chr8_125523895_C_G_b38 : row 3,5 : Maturation of spike protei & Negative regulation of MET activity
chr6_14721666_T_C_b38 : row 2,8 : Loss of function of MECP2 in Rett syndrome & Pervasive developmental disorders
chr18_12775852_G_T_b38 : row 1,7 : Loss of function of MECP2 in Rett syndrome & Pervasive developmental disorders
```

The 4 pathways in this table are: 

[1] "Loss of function of MECP2 in Rett syndrome"

[2] "Maturation of spike protein"               

[3] "Negative regulation of MET activity"       

[4] "Pervasive developmental disorders"

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/info_table_annot_pval_reactome_pc_reg_5_wb_EUR.IBD.rdata")

DT::datatable(final_full, options = list(pageLength =5))
```

## **Detailed results for ukb.allasthma **

ukb.allasthma has 4 factors have p-value == 0  in resampling. The table below shows the SNP details of these 4 factors.

We found 3 SNPs drive different pathways:

```{r echo=T, eval=FALSE}
chr7_20547220_A_G_b38 : row 1,4,8,11 : Cardiac conduction & Ion homeostasis & Ion transport by P-type ATPases
chr5_119355086_C_G_b38 : row 2,5 : Cardiac conduction & Ion homeostasis
chr18_12775852_G_T_b38 : row 3,6,9,12 : Cardiac conduction & Ion homeostasis & Ion transport by P-type ATPases & Muscle contraction
```

The 4 pathways in this table are: 

[1] "Cardiac conduction"             

[2] "Ion homeostasis"                

[3] "Ion transport by P-type ATPases"

[4] "Muscle contraction" 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/info_table_annot_pval_reactome_pc_reg_5_wb_ukb.allasthma.rdata")

DT::datatable(final_full, options = list(pageLength =5))
```