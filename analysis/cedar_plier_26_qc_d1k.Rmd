---
title: "PLIER analysis summary for 6 cell types from CEDAR dataset"
author: "XSun"
date: "2021-06-27"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

# **Overview**

We used the [PLIER R package](https://github.com/wgmao/PLIER) with the collection of 5546 gene sets as a prior information matrix priorMat available in the package comprising canonical, immune and chemgen pathways from MSigDB (same with the eLife paper)


# **LV number** 

| cell type      | LV num |
|----------------|--------|
| platelet       | 132    |
| B cell         | 136    |
| T cell(CD4)    | 146    |
| T cell(CD8)    | 134    |
| monocyte CD14  | 88     |
| neutrophils CD15 | 146    |

# **Summary** 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_cell_sum_plier_qc.png" width="80%">
</figure>

# **Barplot to show the number of SNPs have FDR <0.2 that each pair contains**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/hist_snp_6_plier_CEDAR.jpg" width="80%">
</figure>

# **Detailed results for 6 cell types**

## B cell


### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_bcell_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plier_bcell_cedar_qc.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## monocyte CD14

### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_cd14_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

There is no pair has p-value < 0.05 in resampling.

## neutrophils CD15


### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_cd15_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plier_cd15_cedar_qc.rdata")
DT::datatable(sum, options = list(pageLength =5))
```



## T cell(CD8)



### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_thy_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plier_thy_cedar_qc.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

## T cell(CD4)


### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_tcell_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plier_tcell_cedar_qc.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## platelet


### effectsize fitting summary 

```{r echo=FALSE}
sum <- read.table("/project2/xinhe/xsun/website/factor_analysis/output/simple_sum_pcs_reg_5_d1k_plt_cedar_qc.txt",header = T)
DT::datatable(sum, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plier_plt_cedar_qc.rdata")
DT::datatable(sum, options = list(pageLength =5))
```

