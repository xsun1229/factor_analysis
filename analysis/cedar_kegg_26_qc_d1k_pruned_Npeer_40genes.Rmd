---
title: "Results for KEGG PCs from CEDAR data set (KEGG pathways have >40 genes included)"
author: "XSun"
date: "2021-08-02"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

# **Overview**

We selected the results for pathways have >40 genes from [here](https://xsun1229.github.io/factor_analysis/cedar_kegg_26_qc_d1k_pruned_Npeer.html)

# **Enrichment Summary** 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_cell_sum_kegg_qc_pruned_npeer_40genes.png" width="150%">
</figure>

# **Barplot to show the number of SNPs have FDR <0.2 that each pair contains**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/20_kegg_hist_snp_all_CEDAR.jpg" width="150%">
</figure>

# **Detailed results for 6 cell types**

## B cell

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_bcell_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```




## monocyte CD14


### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,]
DT::datatable(final_full, options = list(pageLength =5))
```
### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd14_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## neutrophils CD15

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd15_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## T cell(CD4)

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_tcell_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## T cell(CD8)

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_thy_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


<!-- ## platelet -->

<!-- ### Histogram to show the number of SNPs that each pair contains -->

<!-- <figure class="half"> -->
<!--     <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/snp_count_plt_cedar_qc_kegg_pruned_npeer_40genes.jpeg" width="80%"> -->
<!-- </figure> -->


<!-- ### effectsize fitting summary -->

<!-- ```{r echo=FALSE} -->
<!-- load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata") -->
<!-- DT::datatable(final_full, options = list(pageLength =5)) -->
<!-- ``` -->

<!-- **The table below shows the pairs have >= 3 SNPs.** -->

<!-- ```{r echo=FALSE} -->
<!-- load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata") -->
<!-- final_full <- final_full[final_full$num_snp_fdr.0.2 > 3,] -->
<!-- DT::datatable(final_full, options = list(pageLength =5)) -->
<!-- ``` -->


<!-- ### SNP details -->

<!-- The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs. -->

<!-- ```{r echo=FALSE} -->
<!-- load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_plt_pruned_npeer_40genes.rdata") -->
<!-- DT::datatable(snp.list.final, options = list(pageLength =5)) -->
<!-- ``` -->



<!-- ### Checking the reverse causality -->

<!-- **The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)** -->

<!-- ```{r echo=FALSE} -->
<!-- load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata") -->
<!-- DT::datatable(sum, options = list(pageLength =5)) -->
<!-- ``` -->


