---
title: "Results for KEGG PCs from CEDAR data set (KEGG pathways have >40 genes included)"
author: "XSun"
date: "2021-08-02"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

# **Overview**

We selected the results for pathways have >40 genes from [here](https://xsun1229.github.io/factor_analysis/cedar_kegg_26_qc_d1k_pruned_Npeer.html)

# **Enrichment Summary** 

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/CEDAR_cell_sum_kegg_qc_pruned_npeer_40genes.png" width="150%">
</figure>

# **Barplot to show the number of SNPs have FDR <0.2 that each pair contains**

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/40_kegg_hist_snp_all_CEDAR.jpg" width="150%">
</figure>

When using p-value < 0.01 && SNP >= 3 as threshold to filter the results, the enrichment results become better. 

# **Detailed results for 6 cell types**

## B cell

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```

After sorting by num_snps and p-value in resampling, we found several pairs seems to be bilogical plausible: 

lymph_pwy182_pc1 : [Differences in lymphocyte developmental potential between human embryonic stem cell and umbilical cord blood–derived hematopoietic progenitor cells](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2556609/)

<figure class="half">
    <img src="https://github.com/xsun1229/factor_analysis/raw/master/output/effectsize_pwy182_pc1_lymph_pval5e8_cedar_bcell.jpeg" width="80%">
</figure>

pct_pwy271_pc4 : [Inflammation drives thrombosis after Salmonella infection via CLEC-2 on platelets](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4665792/)

plt_pwy120_pc4 ： [Role of the platelet chemokine platelet factor 4 (PF4) in hemostasis and thrombosis](https://www.sciencedirect.com/science/article/pii/S0049384809005362)

rdw_pwy255_pc4 ： rdw is related with Alzheimer disease but it seems there is no causal effect.

ukb.allasthma_pwy311_pc5 [A negative trend of association of asthma with AML was also observed but not causal](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4486841/) 



### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_bcell_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_bcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```




## monocyte CD14


### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```
### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd14_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd14_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## neutrophils CD15

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_cd15_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```


### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_cd15_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## T cell(CD4)

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_tcell_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_tcell_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## T cell(CD8)

### effectsize fitting summary 

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```

### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_thy_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```

### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_thy_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


## platelet


### effectsize fitting summary

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(final_full, options = list(pageLength =5))
```

**The table below shows the pairs have >= 3 SNPs && p-value < 0.01.**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/pwy_name_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata")
final_full <- final_full[final_full$num_snp_fdr.0.2 > 2,]
final_full <- final_full[final_full$pval_in_resampling < 0.01,]
DT::datatable(final_full, options = list(pageLength =5))
```


### SNP details

The table below shows the snp details for the pairs have p-value < 0.01 && >= 3 SNPs.

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/snp_details_cedar_kegg_plt_pruned_npeer_40genes.rdata")
DT::datatable(snp.list.final, options = list(pageLength =5))
```



### Checking the reverse causality

**The suffix "_reverse" are the results for traits -> LV (using all candidate SNPs after LD Clumping), the suffix "_rremove" are the results for traits -> LV (using all candidate SNPs after LD Clumping but remove the SNPs have fdr < 0.2)**

```{r echo=FALSE}
load("/project2/xinhe/xsun/website/factor_analysis/output/mbe_plt_cedar_qc_kegg_pruned_npeer_40genes.rdata")
DT::datatable(sum, options = list(pageLength =5))
```


